<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.oracle.s202350104.BoardMapper">

	<select id="boardCount" resultType="int">

		select count(*)
		from board a, users b
		where a.user_id = b.id
		and a.small_code = #{smallCode}

	</select>

	<select id="readCountUp" resultType="int">
		update board 
		set read_count = read_count + 1 
		where id = #{boardId}

	</select>
	
	<select id="noticAllList" resultType="Board">

		select *
		from board a, users b
		where a.user_id = b.id
		and a.small_code = 1

	</select>

	<select id="magazinAllList" resultType="Board">

		select *
		from board a, users b
		where a.user_id = b.id
		and a.small_code = 2

	</select>

	<select id="freeAllList" resultType="Board">

		select *
		from board a, users b
		where a.user_id = b.id
		and a.small_code = 3

	</select>
	
	<select id="photoAllList" resultType="Board">

		select *
		from board a, users b
		where a.user_id = b.id
		and a.small_code = 4

	</select>
	
	<select id="eventAllList" resultType="Board">

		select *
		from board a, users b
		where a.user_id = b.id
		and a.small_code = 5

	</select>

	<select id="boardDetail" parameterType="int" resultType="Board">

		select *
		from board a, users b
		where a.user_id = b.id
		and a.id = #{boardId}

	</select>
	
	<update id="boardUpdate" parameterType="Board">

		update board
		set
			title = #{title},
			content = #{content},
			updated_at = sysdate
		where id = #{id}

	</update>
		
	<delete id="boardDelete" parameterType="int">

		delete from board where id = #{boardId}

	</delete>	
	
	<insert id="boardInsert" parameterType="Board">
		<selectKey keyProperty="id" resultType="integer" order="BEFORE">
			select board_seq_generator.nextval from dual
		</selectKey>
		insert into board (id, user_id, big_code, small_code, 
						   title, content, read_count, created_at) 
		values(#{id}, #{user_id}, #{big_code},
			   #{small_code}, #{title}, #{content}, 0, sysdate)		
	</insert>

</mapper>